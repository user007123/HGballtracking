<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HoverGreens Ball Vision Boot Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { margin:0; background:#000; color:#fff; font-family:Arial; text-align:center; }
  #status { font-size:18px; padding:8px; }
  video, canvas { width:1180px; height:370px; background:#111; display:block; margin:10px auto; }
</style>

<!-- ‚úÖ OpenCV CDN ‚Äî no local wasm needed -->
<script async src="https://cdn.jsdelivr.net/npm/@techstark/opencv-js@4.7.0/dist/opencv.js"></script>

</head>
<body>

<h2>HoverGreens Ball Vision ‚Äî Camera Test</h2>
<div id="status">‚è≥ Loading OpenCV & camera‚Ä¶</div>

<video id="cam" autoplay playsinline></video>
<canvas id="view" width="1180" height="370"></canvas>

<script>
let cvReady = false;
const statusBox = document.getElementById("status");
const video = document.getElementById("cam");
const canvas = document.getElementById("view");
const ctx = canvas.getContext("2d");

// ‚úÖ Start camera
navigator.mediaDevices.getUserMedia({ video:true })
.then(stream => {
  video.srcObject = stream;
  video.onloadedmetadata = () => video.play();
  statusBox.textContent = "üì∑ Camera started ‚Äî waiting for OpenCV‚Ä¶";
})
.catch(err => {
  statusBox.textContent = "‚ùå Camera blocked ‚Äî allow camera in browser";
});

// ‚úÖ OpenCV Ready callback
cv.onRuntimeInitialized = () => {
  cvReady = true;
  statusBox.textContent = "‚úÖ OpenCV Ready ‚Äî drawing enabled";
  loop();
};

// ‚úÖ Draw loop
function loop() {
  // draw mirrored camera feed
  ctx.save();
  ctx.scale(-1, 1);
  ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
  ctx.restore();

  // ‚úÖ debug dot (proves draw loop works)
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(40, 40, 12, 0, Math.PI*2);
  ctx.fill();

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
