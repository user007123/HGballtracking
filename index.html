<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>HoverGreens Ball Vision ‚Äî ASM Mode</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body { margin:0; background:#000; color:#fff; font-family:Arial; text-align:center; }
  #status { font-size:18px; padding:10px; }
  video, canvas { 
    width:1180px; 
    height:370px; 
    background:#111; 
    display:block; 
    margin:10px auto;
  }
</style>

<!-- ‚úÖ Local OpenCV ASM build (no wasm needed) -->
<script src="opencv.js"></script>

<script>
let cvReady = false;

cv['onRuntimeInitialized'] = () => {
  cvReady = true;
  document.getElementById("status").innerText =
    "‚úÖ OpenCV Ready ‚Äî ASM Mode Loaded";
  if (typeof loop === "function") requestAnimationFrame(loop);
};
</script>
</head>
<body>

<h2>HoverGreens Vision ‚Äî Camera + OpenCV Test</h2>
<div id="status">‚è≥ Initializing camera & OpenCV‚Ä¶</div>

<video id="cam" autoplay playsinline></video>
<canvas id="view" width="1180" height="370"></canvas>

<script>
const video = document.getElementById("cam");
const canvas = document.getElementById("view");
const ctx = canvas.getContext("2d");
const statusBox = document.getElementById("status");

// ‚úÖ Start camera (overhead USB or internal)
navigator.mediaDevices.getUserMedia({ video:true })
.then(stream => {
  video.srcObject = stream;
  video.onloadedmetadata = () => video.play();
  statusBox.textContent = "üì∑ Camera started ‚Äî waiting for OpenCV‚Ä¶";
})
.catch(() => {
  statusBox.textContent = "‚ùå Camera blocked ‚Äî enable permissions";
});

// ‚úÖ Draw loop (runs once OpenCV ready)
function loop() {
  // mirrored feed (like putting mirror)
  ctx.save();
  ctx.scale(-1,1);
  ctx.drawImage(video, -canvas.width, 0, canvas.width, canvas.height);
  ctx.restore();

  // ‚úÖ Debug dot (proves render loop works)
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(50, 50, 10, 0, Math.PI*2);
  ctx.fill();

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
